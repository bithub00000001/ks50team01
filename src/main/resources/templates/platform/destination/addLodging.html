<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{platform/layout/default}">
<th:block layout:fragment="customCss">
    <!-- Datatables CSS START -->
    <link th:href="@{/platform/vendors/datatables.net-bs/css/dataTables.bootstrap.min.css}" rel="stylesheet">
    <link th:href="@{/platform/vendors/datatables.net-buttons-bs/css/buttons.bootstrap.min.css}" rel="stylesheet">
    <link th:href="@{/platform/vendors/datatables.net-fixedheader-bs/css/fixedHeader.bootstrap.min.css}" rel="stylesheet">
    <link th:href="@{/platform/vendors/datatables.net-responsive-bs/css/responsive.bootstrap.min.css}" rel="stylesheet">
    <link th:href="@{/platform/vendors/datatables.net-scroller-bs/css/scroller.bootstrap.min.css}" rel="stylesheet">
    <!-- Datatables CSS END -->
</th:block>

	
<th:block layout:fragment="customContent">

	<div class="x_content">
		<div class="clearfix"></div>
	</div>
	<div class="row">
		<div class="col-xs-12 table">
			<h1 th:text="${title}"></h1>
			<form th:action="@{/platform/destination/addLodging}" method="post">
				<table id="datatable-responsive"
					class="table table-striped table-bordered dt-responsive nowrap"
					cellspacing="0" width="100%">
					<tbody>
						<tr>
							<td><label for="lodgingName">숙소 이름</label></td>
							<td><input type="text" id="lodgingName" name="lodgingName" placeholder="숙소를 입력해주세요" />
								<button type="button" id="nameCheck">중복 숙소 체크</button>
							</td>
						</tr>
						<tr>
							<td><label for="lodgingInfoCode">숙소 코드</label></td>
							<td colspan="2"><input type="text" id="lodgingInfoCode" name="lodgingInfoCode" placeholder="ex: ln_" disabled="disabled"></td>
						</tr>
						<tr>
							<td><label for="lodgingAuthorityId">등록 권한자 아이디</label></td>
							<td colspan="2"><input type="text" id="lodgingAuthorityId" name="lodgingAuthorityId" placeholder="ex: admin_001" disabled="disabled" /></td>
						</tr>
						<tr>
							<td><label for="tripSCateCode">여행지 소분류 코드</label></td>
							<td colspan="2"><input type="text" id="tripSCateCode" name="tripSCateCode" placeholder="ex: TRIP_SCTGRY_000" disabled="disabled" /></td>
						</tr>
						<tr>
							<td><label for="partnerBPlaceCode">제휴 사업장 코드</label></td>
							<td colspan="2"><input type="text" id="partnerBPlaceCode" name="partnerBPlaceCode" placeholder="ex: tour_001" disabled="disabled" /></td>
						</tr>
						<tr>
							<td><label for="regionSCateName">지역소분류명</label></td>
							<td colspan="2"><input type="text" id="regionSCateName" name="regionSCateName" placeholder="지역소분류 명을 입력해주세요" disabled="disabled" /></td>
						</tr>
						<tr>
							<td><label for="lodgingAddr">숙소 주소</label></td>
							<td colspan="2"><input type="text" id="lodgingAddr" name="lodgingAddr" placeholder="주소를 입력해주세요" disabled="disabled" /></td>
						</tr>
						<tr>
							<td><label for="lodgingDaddr">숙소 세부주소</label></td>
							<td colspan="2"><input type="text" id="lodgingDaddr" name="lodgingDaddr" placeholder="관광지 세부조소를 입력해주세요" disabled="disabled" /></td>
						</tr>
						<tr>
							<td><label for="lodgingSite">속소 사이트</label></td>
							<td colspan="2"><input type="text" id="lodgingSite" name="lodgingSite" placeholder="관광지 사이트를 입력해주세요" disabled="disabled" /></td>
						</tr>
						<tr>
							<td><label for="lodgingContactNum">숙소 연락처1</label></td>
							<td colspan="2"><input type="text" id="lodgingContactNum" name="lodgingContactNum" placeholder="관광지 연락처를 입력해주세요" disabled="disabled" /></td>
						</tr>
						<tr>
							<td><label for="lodgingContactNum2">숙소 연락처2</label></td>
							<td colspan="2"><input type="text" id="lodgingContactNum2" name="lodgingContactNum2" placeholder="관광지 연락처를 입력해주세요" disabled="disabled" /></td>
						</tr>
						
					<tfoot>
						<tr>
							<td colspan="3">
								<button type="button" class="btn btn-primary" id="addMemberBtn" disabled="disabled">등록</button>
								<button type="reset" class="btn btn-success" id="resetBtn" disabled="disabled">초기화</button>
								<button type="button" class="btn btn-secondary" id="btn-cancel">취소</button>
							</td>
						</tr>
					</tfoot>
				</table>
			</form>
		</div>
	</div>
</th:block>


<th:block layout:fragment="customJsFile">
	<!-- Datatables JS START -->
	<script th:src="@{/platform/vendors/datatables.net/js/jquery.dataTables.min.js}"></script>
	<script th:src="@{/platform/vendors/datatables.net-bs/js/dataTables.bootstrap.min.js}"></script>
	<script th:src="@{/platform/vendors/datatables.net-buttons/js/dataTables.buttons.min.js}"></script>
	<script th:src="@{/platform/vendors/datatables.net-buttons-bs/js/buttons.bootstrap.min.js}"></script>
	<script th:src="@{/platform/vendors/datatables.net-buttons/js/buttons.flash.min.js}"></script>
	<script th:src="@{/platform/vendors/datatables.net-buttons/js/buttons.html5.min.js}"></script>
	<script th:src="@{/platform/vendors/datatables.net-buttons/js/buttons.print.min.js}"></script>
	<script th:src="@{/platform/vendors/datatables.net-fixedheader/js/dataTables.fixedHeader.min.js}"></script>
	<script th:src="@{/platform/vendors/datatables.net-keytable/js/dataTables.keyTable.min.js}"></script>
	<script th:src="@{/platform/vendors/datatables.net-responsive/js/dataTables.responsive.min.js}"></script>
	<script th:src="@{/platform/vendors/datatables.net-responsive-bs/js/responsive.bootstrap.js}"></script>
	<script th:src="@{/platform/vendors/datatables.net-scroller/js/dataTables.scroller.min.js}"></script>
	<script th:src="@{/platform/vendors/jszip/dist/jszip.min.js}"></script>
	<script th:src="@{/platform/vendors/pdfmake/build/pdfmake.min.js}"></script>
	<script th:src="@{/platform/vendors/pdfmake/build/vfs_fonts.js}"></script>
	<!-- Datatables JS END -->

</th:block>	
	  
	  <th:block layout:fragment="customJs">
		<script>		
			$('#nameCheck').click(function(){
				const lodgingName = $('#lodgingName').val();
				//const $memberId = $('#memberId')[0];
				//console.log({$memberId});
				//console.log(typeof memberId);
				if(lodgingName == ''){
					alert('숙소 이름을 입력해주세요');
					$('#lodgingName').focus();
					return ;
				}
				const request = $.ajax({
					method : 'GET',
					url : '/platform/destination/addLodgingCheckList',
					data : {'lodgingName' : lodgingName},
					dataType : 'json'
				});
				request.done(function(res){
					console.log(res);
					console.log(typeof res);
					const isLodgingName = res;
					$('form input').not('#lodgingName').prop('disabled', isLodgingName);
					$('form select').prop('disabled', isLodgingName);
					$('form button').not('#nameCheck').prop('disabled', isLodgingName);
					if(isLodgingName){
						alert('등록 할 수 없는 숙소입니다.');
						$('form input').val('');
						$('form select').val('');
						$('#lodgingName').focus();
					}
				});
				request.fail(function(jqXHR, textStatus, error){
					console.log(error);
				});
			});
			$('#lodgingName').change(function(){
				$('form input').not('#lodgingName').prop('disabled', true);
				$('form select').prop('disabled', true);
				$('form button').not('#nameCheck').prop('disabled', true);
			}); 
						
			$('#addMemberBtn').click(function(){
				const lodgingName = $('lodgingName').val();
				const lodgingInfoCode = $('lodgingInfoCode').val();
				const lodgingAuthorityId = $('lodgingAuthorityId').val();
				const lodgingAddr = $('lodgingAddr').val();
				const lodgingDaddr = $('lodgingDaddr').val();
				const lodgingSite = $('lodgingSite').val();
				const lodgingContactNum = $('lodgingContactNum').val();
				const lodgingContactNum2 = $('lodgingContactNum2').val();
				
				
				let isSubmit = true;
				$('form input, form select').each(function(idx, element){
					const id = element.id;
					const value = $(element).val();
					if(value == ''){
						const cate = $(`label[for="${id}"]`).text();
						alert(`${cate} 필수 입력항목입니다.`);
						$(element).focus();
						isSubmit = false;
						return false;
					}
				});
				if(isSubmit) $('form').submit();
			});
		</script>
		   <script th:inline="javascript">
		        $('#btn-cancel').click(function () {
		            window.history.back();
		        })
   			</script>
				
</th:block>
</html>