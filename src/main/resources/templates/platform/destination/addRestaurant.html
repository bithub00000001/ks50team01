<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{platform/layout/default}">
<th:block layout:fragment="customCss">
    <!-- Datatables CSS START -->
    <link th:href="@{/platform/vendors/datatables.net-bs/css/dataTables.bootstrap.min.css}" rel="stylesheet">
    <link th:href="@{/platform/vendors/datatables.net-buttons-bs/css/buttons.bootstrap.min.css}" rel="stylesheet">
    <link th:href="@{/platform/vendors/datatables.net-fixedheader-bs/css/fixedHeader.bootstrap.min.css}" rel="stylesheet">
    <link th:href="@{/platform/vendors/datatables.net-responsive-bs/css/responsive.bootstrap.min.css}" rel="stylesheet">
    <link th:href="@{/platform/vendors/datatables.net-scroller-bs/css/scroller.bootstrap.min.css}" rel="stylesheet">
    <!-- Datatables CSS END -->
</th:block>

	
<th:block layout:fragment="customContent">

	<div class="x_content">
		<div class="clearfix"></div>
	</div>
	<div class="row">
		<div class="col-xs-12 table">
			<h1 th:text="${title}"></h1>
			<form th:action="@{/platform/destination/addTour}" method="post">
				<table id="datatable-responsive"
					class="table table-striped table-bordered dt-responsive nowrap"
					cellspacing="0" width="100%">
					<tbody>
						<tr>
							<td><label for="restaurantName">음식점 이름</label></td>
							<td><input type="text" id="restaurantName" name="restaurantName" placeholder="음식점을 입력해주세요" />
								<button type="button" id="nameCheck">중복 관광지 체크</button>
							</td>
						</tr>
						<tr>
							<td><label for="restaurantInfoCode">음식점 코드</label></td>
							<td colspan="2"><input type="text" id="restaurantInfoCode" name="restaurantInfoCode" placeholder="ex: RSTRN_INFO_" disabled="disabled"></td>
						</tr>
						<tr>
							<td><label for="tripSCateCode">여행지 소분류 코드</label></td>
							<td colspan="2"><input type="text" id="tripSCateCode" name="tripSCateCode" placeholder="ex: TRIP_SCTGRY_" disabled="disabled"></td>
						</tr>

						<tr>
							<td><label for="partnerBPlaceCode">제휴사업장 코드</label></td>
							<td colspan="2"><input type="text" id="partnerBPlaceCode" name="partnerBPlaceCode" placeholder="ex: tour_001" disabled="disabled"></td>
						</tr>
						<tr>
							<td><label for="restaurantAuthorityId">음식점 등록권한자 아이디</label></td>
							<td colspan="2"><input type="text" id="restaurantAuthorityId" name="restaurantAuthorityId" placeholder="ex: admin001" disabled="disabled"></td>
						</tr>
						<tr>
							<td><label for="restaurantAddr">음식점 주소</label></td>
							<td colspan="2"><input type="text" id="restaurantAddr" name="restaurantAddr" placeholder="주소를 입력해주세요" disabled="disabled"></td>
						</tr>
						
						<tr>
							<td><label for="restaurantDaddr">음식점 상세주소</label></td>
							<td colspan="2"><input type="text" id="restaurantDaddr" name="restaurantDaddr" placeholder="상세주소를 입력해주세요" disabled="disabled" /></td>
						</tr>
						<tr>
							<td><label for="restaurantSite">음시점 사이트</label></td>
							<td colspan="2"><input type="text" id="restaurantSite" name="restaurantSite" placeholder="사이트를 입력해주세요" disabled="disabled" /></td>
						</tr>
						<tr>
							<td><label for="restaurantContactNum">음식점 연락처</label></td>
							<td colspan="2"><input type="text" id="restaurantContactNum" name="restaurantContactNum" placeholder="연락처를 입력해주세요" disabled="disabled" /></td>
						</tr>
						<tr>
							<td><label for="restaurantOthers">음식점 기타사항</label></td>
							<td colspan="2"><input type="text" id="restaurantOthers" name="restaurantOthers" placeholder="기타 사항을 입력해주세요" disabled="disabled" /></td>
						</tr>
						<tr>
							<td><label for="restaurantRegDate">등록일자</label></td>
							<td colspan="2"><input type="text" id="restaurantRegDate" name="restaurantRegDate" placeholder="등록일자를 입력해주세요" disabled="disabled" /></td>
						</tr>
						
					<tfoot>
						<tr>
							<td colspan="3">
								<button type="button" class="btn btn-primary" id="addMemberBtn" disabled="disabled">등록</button>
								<button type="reset" class="btn btn-success" id="resetBtn" disabled="disabled">초기화</button>
								<button type="button" class="btn btn-secondary" id="btn-cancel">취소</button>
							</td>
						</tr>
					</tfoot>
				</table>
			</form>
		</div>
	</div>
</th:block>


<th:block layout:fragment="customJsFile">
	<!-- Datatables JS START -->
	<script th:src="@{/platform/vendors/datatables.net/js/jquery.dataTables.min.js}"></script>
	<script th:src="@{/platform/vendors/datatables.net-bs/js/dataTables.bootstrap.min.js}"></script>
	<script th:src="@{/platform/vendors/datatables.net-buttons/js/dataTables.buttons.min.js}"></script>
	<script th:src="@{/platform/vendors/datatables.net-buttons-bs/js/buttons.bootstrap.min.js}"></script>
	<script th:src="@{/platform/vendors/datatables.net-buttons/js/buttons.flash.min.js}"></script>
	<script th:src="@{/platform/vendors/datatables.net-buttons/js/buttons.html5.min.js}"></script>
	<script th:src="@{/platform/vendors/datatables.net-buttons/js/buttons.print.min.js}"></script>
	<script th:src="@{/platform/vendors/datatables.net-fixedheader/js/dataTables.fixedHeader.min.js}"></script>
	<script th:src="@{/platform/vendors/datatables.net-keytable/js/dataTables.keyTable.min.js}"></script>
	<script th:src="@{/platform/vendors/datatables.net-responsive/js/dataTables.responsive.min.js}"></script>
	<script th:src="@{/platform/vendors/datatables.net-responsive-bs/js/responsive.bootstrap.js}"></script>
	<script th:src="@{/platform/vendors/datatables.net-scroller/js/dataTables.scroller.min.js}"></script>
	<script th:src="@{/platform/vendors/jszip/dist/jszip.min.js}"></script>
	<script th:src="@{/platform/vendors/pdfmake/build/pdfmake.min.js}"></script>
	<script th:src="@{/platform/vendors/pdfmake/build/vfs_fonts.js}"></script>
	<!-- Datatables JS END -->

</th:block>	
	  
	  <th:block layout:fragment="customJs">
		<script>		
			$('#nameCheck').click(function(){
				const restaurantName = $('#restaurantName').val();
				//const $memberId = $('#memberId')[0];
				//console.log({$memberId});
				//console.log(typeof memberId);
				if(restaurantName == ''){
					alert('식당이름을 입력해주세요');
					$('#restaurantName').focus();
					return ;
				}
				const request = $.ajax({
					method : 'GET',
					url : '/platform/destination/addRestaurantCheckList',
					data : {'restaurantName' : restaurantName},
					dataType : 'json'
				});
				request.done(function(res){
					console.log(res);
					console.log(typeof res);
					const isTourName = res;
					$('form input').not('#restaurantName').prop('disabled', isRestaurantName);
					$('form select').prop('disabled', isRestaurantName);
					$('form button').not('#nameCheck').prop('disabled', isRestaurantName);
					if(isRestaurantName){
						alert('등록 할 수 없는 이름입니다.');
						$('form input').val('');
						$('form select').val('');
						$('#tourName').focus();
					}
				});
				request.fail(function(jqXHR, textStatus, error){
					console.log(error);
				});
			});
			$('#restaurantName').change(function(){
				$('form input').not('#restaurantName').prop('disabled', true);
				$('form select').prop('disabled', true);
				$('form button').not('#nameCheck').prop('disabled', true);
			}); 
						
			$('#addMemberBtn').click(function(){
				const tourName = $('restaurantName').val();
				const tourInfoCode = $('restaurantInfoCode').val();
				const tourAuthorityId = $('restaurantAuthorityId').val();
				const tourAddr = $('restaurantAddr').val();
				const tourDaddr = $('restaurantDaddr').val();
				const tourSite = $('restaurantSite').val();
				const tourContactNum = $('restaurantContactNum').val();
				const tourContactNum2 = $('restaurantOthers').val();
				
				let isSubmit = true;
				$('form input, form select').each(function(idx, element){
					const id = element.id;
					const value = $(element).val();
					if(value == ''){
						const cate = $(`label[for="${id}"]`).text();
						alert(`${cate} 필수 입력항목입니다.`);
						$(element).focus();
						isSubmit = false;
						return false;
					}
				});
				if(isSubmit) $('form').submit();
			});
		</script>
		   <script th:inline="javascript">
		        $('#btn-cancel').click(function () {
		            window.history.back();
		        })
   			</script>
				
</th:block>
</html>