<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{platform/layout/default}">

<th:block layout:fragment="customCss">
    <!-- Datatables CSS START -->
    <link th:href="@{/platform/vendors/datatables.net-bs/css/dataTables.bootstrap.min.css}" rel="stylesheet">
    <link th:href="@{/platform/vendors/datatables.net-buttons-bs/css/buttons.bootstrap.min.css}" rel="stylesheet">
    <link th:href="@{/platform/vendors/datatables.net-fixedheader-bs/css/fixedHeader.bootstrap.min.css}" rel="stylesheet">
    <link th:href="@{/platform/vendors/datatables.net-responsive-bs/css/responsive.bootstrap.min.css}" rel="stylesheet">
    <link th:href="@{/platform/vendors/datatables.net-scroller-bs/css/scroller.bootstrap.min.css}" rel="stylesheet">
    <!-- Datatables CSS END -->
</th:block>

	<th:block layout:fragment="customContent">
		
    <div class="x_content">
		<div class="clearfix"></div>
    </div>
            <div class="row">
                <div class="col-xs-12 table">
                 <h1 th:text="${title}"></h1>
                  <form th:action="@{/platform/ranking/addPlanUserRanking}" method="post">   
                    <table id="datatable-responsive" class="table table-striped table-bordered dt-responsive nowrap"  cellspacing="0" width="100%">
                        <tbody>
							<tr>
								<td><label for="userTripPlanId">회원추천</label></td>
								<td><input type="hidden" id="userTripPlanId" name="userTripPlanId" />
								</td>
							</tr>
							<tr>
								<td><label for="pRankingRegId">등록플랫폼권한아이디</label></td>
								<td colspan="2"><input type="text" id="pRankingRegId"
									name="pRankingRegId" placeholder="ex: admin001" >
								</td>
							</tr>
							<tr>
								<td><label for="tripPlanNum">개별여행계획번호</label></td>
								<td colspan="2"><input type="text" id="tripPlanNum"
									name="tripPlanNum" placeholder="개별여행계획번호를 입력하세요"  />
									<select>
										<option>ind_trip_0</option>
									</select>
								</td>
							</tr>
							<tr>
								<td>
									<label for="rgnSctgryName">지역소분류명</label>
								</td>
								<td colspan="2">
									<input type="text" id="rgnSctgryName" name="rgnSctgryName" placeholder="지역소분류명을 입력하세요" />
								</td>
							</tr>
							<tr>
								<td>
									<label for="planTitle">여행계획 제목</label>
								</td>
								<td colspan="2">
									<input type="text" id="planTitle" name="planTitle" placeholder="여행계획 제목을 입력하세요" />
								</td>
							</tr>
							<tr>
								<td>
									<label for="planDetail">지역소분류명</label>
								</td>
								<td colspan="2">
									<input type="text" id="planDetail" name="planDetail" placeholder="여행계획 내용을 입력하세요" />
								</td>
							</tr>
							<tr>
								<td>
									<label for="tripPlanRank">순위</label>
								</td>
								<td colspan="2">
									<input type="text" id="tripPlanRank" name="tripPlanRank" placeholder="순위를 입력해주세요" />
									<button type="button" id="idCheck">중복체크</button>
								</td>
							</tr>
						
							<tr>
								<td>
									<label for="reviewStatsStart">한달기준합계시작일</label>
								</td>
								<td colspan="2">
									<input type="text" id="reviewStatsStart" name="reviewStatsStart" placeholder="ex: 0000-00-00" />
								</td>
							</tr>
							<tr>
								<td>
									<label for="reviewStatsEnd">한달기분합계종료일</label>
								</td>
								<td colspan="2">
									<input type="text" id="reviewStatsEnd" name="reviewStatsEnd" placeholder="ex: 0000-00-00" />
								</td>
							</tr>
							<tr>
								<td>
									<label for="platformAdStart">플랫폼게시기간시작일</label>
								</td>
								<td colspan="2">
									<input type="text" id="platformAdStart" name="platformAdStart" placeholder="0000-00-00" />
								</td>
							</tr>
							<tr>
								<td>
									<label for="platformAdEnd">플랫폼게시기간종료일</label>
								</td>
								<td colspan="2">
									<input type="text" id="platformAdEnd" name="platformAdEnd" placeholder="0000-00-00" />
								</td>
							</tr>
							
							<tr>
								<td>
									<label for="activate">활성화여부</label>
								</td>
								<td colspan="2">
									<input type="text" id="activate" name="activate" placeholder="ex: Y or N" />
								</td>
							</tr>
	
						</tbody>
						<tfoot>
							<tr>
								<td colspan="3">
									<button type="button" id="addPlanUserRankingBtn" >등록</button>
									<button type="reset" id="resetBtn" >초기화</button>
								</td>
							</tr>
						</tfoot>	
						</table>
					</form>
				</div>
			</div>
	</th:block>
	
	</th:block>
<th:block layout:fragment="customJsFile">
    <!-- Datatables JS START -->
    <script th:src="@{/platform/vendors/datatables.net/js/jquery.dataTables.min.js}"></script>
    <script th:src="@{/platform/vendors/datatables.net-bs/js/dataTables.bootstrap.min.js}"></script>
    <script th:src="@{/platform/vendors/datatables.net-buttons/js/dataTables.buttons.min.js}"></script>
    <script th:src="@{/platform/vendors/datatables.net-buttons-bs/js/buttons.bootstrap.min.js}"></script>
    <script th:src="@{/platform/vendors/datatables.net-buttons/js/buttons.flash.min.js}"></script>
    <script th:src="@{/platform/vendors/datatables.net-buttons/js/buttons.html5.min.js}"></script>
    <script th:src="@{/platform/vendors/datatables.net-buttons/js/buttons.print.min.js}"></script>
    <script th:src="@{/platform/vendors/datatables.net-fixedheader/js/dataTables.fixedHeader.min.js}"></script>
    <script th:src="@{/platform/vendors/datatables.net-keytable/js/dataTables.keyTable.min.js}"></script>
    <script th:src="@{/platform/vendors/datatables.net-responsive/js/dataTables.responsive.min.js}"></script>
    <script th:src="@{/platform/vendors/datatables.net-responsive-bs/js/responsive.bootstrap.js}"></script>
    <script th:src="@{/platform/vendors/datatables.net-scroller/js/dataTables.scroller.min.js}"></script>
    <script th:src="@{/platform/vendors/jszip/dist/jszip.min.js}"></script>
    <script th:src="@{/platform/vendors/pdfmake/build/pdfmake.min.js}"></script>
    <script th:src="@{/platform/vendors/pdfmake/build/vfs_fonts.js}"></script>
    <!-- Datatables JS END -->
    
    <th:block layout:fragment="customJs">
		<script>		
			$('#idCheck').click(function(){
				const tripPlanRank = $('#tripPlanRank').val();
				//const $memberId = $('#memberId')[0];
				//console.log({$memberId});
				//console.log(typeof memberId);
				if(tripPlanRank == ''){
					alert('순위를 입력해주세요');
					$('#tripPlanRank').focus();
					return ;
				}
				const request = $.ajax({
					method : 'POST',
					url : '/platform/ranking/planRankingListCheck',
					data : { 'tripPlanRank' : tripPlanRank },
					dataType : 'json'
				});
				request.done(function(res){
					console.log(res);
					console.log(typeof res);
					const isTripPlanRank = res;
					$('form input').not('#tripPlanRank').prop('disabled', isTripPlanRank);
					$('form select').prop('disabled', isTripPlanRank);
					$('form button').not('#idCheck').prop('disabled', isTripPlanRank);
					if(isTripPlanRank){
						alert('등록할 수 없는 순위입니다.');
						$('form input').val('');
						$('#tripPlanRank').focus();
					}
				});
				request.fail(function(jqXHR, textStatus, error){
					console.log(error);
				});
			});
			$('#tripPlanRank').change(function(){
				$('form input').not('#tripPlanRank').prop('disabled', true);
				$('form select').prop('disabled', false);
				$('form button').not('#idCheck').prop('disabled', true);
			});
						
			$('#addPlanUserRankingBtn').click(function(){
				const pRankingRegId = $('pRankingRegId').val();
				const tripPlanNum = $('tripPlanNum').val();
				const rgnSctgryName = $('rgnSctgryName').val();
				const planTitle = $('planTitle').val();
				const planDetail = $('planDetail').val();
				const tripPlanRank = $('tripPlanRank').val();
				const reviewStatsStart = $('reviewStatsStart').val();
				const reviewStatsEnd = $('reviewStatsEnd').val();
				const platformAdStart = $('platformAdStart').val();
				const platformAdEnd = $('platformAdEnd').val();
				const activate = $('activate').val();
				
				let isSubmit = true; 
				$('form input, form select').each(function(idx, element){
					const id = element.id;
					const value = $(element).val();
					if(tripPlanRank == ''){
						const cate = $(`label[for="${id}"]`).text();
						alert(`${cate} 필수 입력항목입니다.`);
						$(element).focus();
						isSubmit = false;
						return false;
					}
				});
				
			/* if(!memberId){
				alert('아이디를 입력해주세요');
				return;
			} 
			if(!memberPw){
				alert('비밀번호를 입력해주세요');
				return;
			}
			if(!memberName){
				alert('이름를 입력해주세요');
				return;
			}
			if(!memberLevel){
				alert('권한을 선택해주세요');
				return;
			}
			if(!memberEmail){
				alert('이메일을 입력해주세요');
				return;
			}
			if(!memberAddr){
				alert('주소를 입력해주세요');
				return;
			} */
				if(isSubmit) $('form').submit();
			});
		</script>
</th:block>
</html>