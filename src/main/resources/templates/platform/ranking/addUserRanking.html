<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{platform/layout/default}">

<th:block layout:fragment="customCss">
    <!-- Datatables CSS START -->
    <link th:href="@{/platform/vendors/datatables.net-bs/css/dataTables.bootstrap.min.css}" rel="stylesheet">
    <link th:href="@{/platform/vendors/datatables.net-buttons-bs/css/buttons.bootstrap.min.css}" rel="stylesheet">
    <link th:href="@{/platform/vendors/datatables.net-fixedheader-bs/css/fixedHeader.bootstrap.min.css}" rel="stylesheet">
    <link th:href="@{/platform/vendors/datatables.net-responsive-bs/css/responsive.bootstrap.min.css}" rel="stylesheet">
    <link th:href="@{/platform/vendors/datatables.net-scroller-bs/css/scroller.bootstrap.min.css}" rel="stylesheet">
    <!-- Datatables CSS END -->
</th:block>

<th:block layout:fragment="customContent">
		
    <div class="x_content">
		<div class="clearfix"></div>
    </div>
            <div class="row">
                <div class="col-xs-12 table">
                 <h1 th:text="${title}"></h1>
                  <form th:action="@{/platform/ranking/addUserRanking}" method="post">   
                    <table id="datatable-responsive" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%">
                        <tbody>
							<tr>
								<td><label for="userRankingId">회원추천리스트아이디</label></td>
								<td colspan="2"><input type="hidden" id="userRankingId" name="userRankingId" />
								</td>
							</tr>
							<tr>
								<td><label for="userRankingRegId">등록플랫폼권한아이디</label></td>
								<td colspan="2"><input type="text" id="userRankingRegId"
									name="userRankingRegId" placeholder="ex: admin001" >
								</td>
							</tr>
							<tr>
								<td><label for="partnerBusinessCode">제휴사업장코드</label></td>
								<td colspan="2"><input type="text" id="partnerBusinessCode"
									name="partnerBusinessCode" placeholder="제휴사업장코드를 입력해주세요"  />
									<select>
										<option>숙소 hotel_000</option>
										<option>음식점 RSTRN_000</option>
										<option>관광지 tour_000</option>
									</select>
								</td>
							</tr>
							<tr>
								<td>
									<label for="tripLctgryCode">여행지대분류코드</label>
								</td>
								<td colspan="2">
									<input type="text" id="tripLctgryCode" name="tripLctgryCode" placeholder="여행지대분류코드를 입력해주세요" />
									<select>
										<option>관광지 TRIP_LCTGRY_01</option>
										<option>음식점 TRIP_LCTGRY_02</option>
										<option>숙소 TRIP_LCTGRY_03</option>
										<option>기타 TRIP_LCTGRY_04</option>
									</select>
								</td>
							</tr>
							<tr>
								<td>
									<label for=destinationType>관광타입</label>
								</td>
								<td colspan="2">
									<input type="text" id="destinationType" name="destinationType" placeholder="관광타입을 입력해주세요" />
								</td>
							</tr>
							<tr>
								<td>
									<label for="destinationCId">컨텐츠아이디</label>
								</td>
								<td colspan="2">
									<input type="text" id="destinationCId" name="destinationCId" placeholder="컨텐츠아이디를 입력해주세요" />
								</td>
							</tr>
							<tr>
								<td>
									<label for="destinationDetail">추천내용</label>
								</td>
								<td colspan="2">
									<input type="text" id="destinationDetail" name="destinationDetail" placeholder="추천내용을 입력해주세요" />
								</td>
							</tr>
							<tr>
								<td>
									<label for="userRank">최종순위</label>
								</td>
								<td colspan="2">
									<input type="text" id="userRank" name="userRank" placeholder="최종순위를 입력해주세요" />
									<button type="button" id="idCheck">중복체크</button>
								</td>
							</tr>
							<tr>
								<td>
									<label for="reviewStatsStart">한달기준합계시작일</label>
								</td>
								<td colspan="2">
									<input type="text" id="reviewStatsStart" name="reviewStatsStart" placeholder="ex: 0000-00-00" />
								</td>
							</tr>
							<tr>
								<td>
									<label for="reviewStatsEnd">한달기분합계종료일</label>
								</td>
								<td colspan="2">
									<input type="text" id="reviewStatsEnd" name="reviewStatsEnd" placeholder="ex: 0000-00-00" />
								</td>
							</tr>
							<tr>
								<td>
									<label for="platformAdStart">플랫폼게시기간시작일</label>
								</td>
								<td colspan="2">
									<input type="text" id="platformAdStart" name="platformAdStart" placeholder="0000-00-00" />
								</td>
							</tr>
							<tr>
								<td>
									<label for="platformAdEnd">플랫폼게시기간종료일</label>
								</td>
								<td colspan="2">
									<input type="text" id="platformAdEnd" name="platformAdEnd" placeholder="0000-00-00" />
								</td>
							</tr>
							
							<tr>
								<td>
									<label for="activate">활성화여부</label>
								</td>
								<td colspan="2">
									<input type="text" id="activate" name="activate" placeholder="ex: Y or N" />
								</td>
							</tr>
	
						</tbody>
						<tfoot>
							<tr>
								<td colspan="3">
									<button type="button" id="addUserRankingBtn" >등록</button>
									<button type="reset" id="resetBtn" >초기화</button>
								</td>
							</tr>
						</tfoot>	
						</table>
					</form>
				</div>
			</div>
</th:block>
	

<th:block layout:fragment="customJsFile">
    <!-- Datatables JS START -->
    <script th:src="@{/platform/vendors/datatables.net/js/jquery.dataTables.min.js}"></script>
    <script th:src="@{/platform/vendors/datatables.net-bs/js/dataTables.bootstrap.min.js}"></script>
    <script th:src="@{/platform/vendors/datatables.net-buttons/js/dataTables.buttons.min.js}"></script>
    <script th:src="@{/platform/vendors/datatables.net-buttons-bs/js/buttons.bootstrap.min.js}"></script>
    <script th:src="@{/platform/vendors/datatables.net-buttons/js/buttons.flash.min.js}"></script>
    <script th:src="@{/platform/vendors/datatables.net-buttons/js/buttons.html5.min.js}"></script>
    <script th:src="@{/platform/vendors/datatables.net-buttons/js/buttons.print.min.js}"></script>
    <script th:src="@{/platform/vendors/datatables.net-fixedheader/js/dataTables.fixedHeader.min.js}"></script>
    <script th:src="@{/platform/vendors/datatables.net-keytable/js/dataTables.keyTable.min.js}"></script>
    <script th:src="@{/platform/vendors/datatables.net-responsive/js/dataTables.responsive.min.js}"></script>
    <script th:src="@{/platform/vendors/datatables.net-responsive-bs/js/responsive.bootstrap.js}"></script>
    <script th:src="@{/platform/vendors/datatables.net-scroller/js/dataTables.scroller.min.js}"></script>
    <script th:src="@{/platform/vendors/jszip/dist/jszip.min.js}"></script>
    <script th:src="@{/platform/vendors/pdfmake/build/pdfmake.min.js}"></script>
    <script th:src="@{/platform/vendors/pdfmake/build/vfs_fonts.js}"></script>
    <!-- Datatables JS END -->
    
 <th:block layout:fragment="customJs">
		<script>		
			$('#idCheck').click(function(){
				const userRank = $('#userRank').val();
				//const $memberId = $('#memberId')[0];
				//console.log({$memberId});
				//console.log(typeof memberId);
				if(userRank == ''){
					alert('순위를 입력해주세요');
					$('#userRank').focus();
					return ;
				}
				const request = $.ajax({
					method : 'POST',
					url : '/platform/ranking/userRankingListCheck',
					data : { 'userRank' : userRank },
					dataType : 'json'
				});
				request.done(function(res){
					console.log(res);
					console.log(typeof res);
					const isUserRank = res;
					$('form input').not('#userRank').prop('disabled', isUserRank);
					$('form select').prop('disabled', isUserRank);
					$('form button').not('#idCheck').prop('disabled', isUserRank);
					if(isUserRank){
						alert('등록할 수 없는 순위입니다.');
						$('form input').val('');
						$('#userRank').focus();
					}
				});
				request.fail(function(jqXHR, textStatus, error){
					console.log(error);
				});
			});
			$('#userRank').change(function(){
				$('form input').not('#userRank').prop('disabled', true);
				$('form select').prop('disabled', false);
				$('form button').not('#idCheck').prop('disabled', true);
			});
						
			$('#addUserRankingBtn').click(function(){
				const userRankingRegId = $('userRankingRegId').val();
				const partnerBusinessCode = $('partnerBusinessCode').val();
				const tripLctgryCode = $('tripLctgryCode').val();
				const destinationType = $('destinationType').val();
				const destinationCId = $('destinationCId').val();
				const userRank = $('userRank').val();
				const reviewStatsStart = $('reviewStatsStart').val();
				const reviewStatsEnd = $('reviewStatsEnd').val();
				const platformAdStart = $('platformAdStart').val();
				const platformAdEnd = $('platformAdEnd').val();
				const activate = $('activate').val();
				
				let isSubmit = true;
				$('form input, form select').each(function(idx, element){
					const id = element.id;
					const value = $(element).val();
					if(userRank == ''){
						const cate = $(`label[for="${id}"]`).text();
						alert(`${cate} 필수 입력항목입니다.`);
						$(element).focus();
						isSubmit = false;
						return false;
					}
				});

				if(isSubmit) $('form').submit();
			});
		</script>
</th:block>
</html>