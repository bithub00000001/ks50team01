<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
                xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
                layout:decorate="~{user/layout/default}">
                
	<head>
	<title>1:1문의 작성</title>
	</head>
	
	<th:block layout:fragment="customCss">
		<link th:href="@{/user/css/qnaWrite.css}" rel="stylesheet">
		
		<!-- GOOGLE FONT -->
    	<link href='https://fonts.googleapis.com/css?family=Montserrat:400,500,600,700' rel='stylesheet'>
	</th:block>

	<th:block layout:fragment="customPageSection">
		<!-- Elements Forms -->
		<section class="py-10">
			<div class="row">
				<div class="col-12">
					<h3 class="element-title">1:1 문의 작성</h3>
					<div class="mb-6">
						<form id="qnaForm" action="#" method="POST"
							enctype="multipart/form-data">
							<div class="form-group">
								<label for="qnaRegId" class="col-sm-2 col-form-label">작성자</label>
								<input type="text" class="form-control" id="qnaRegId" name="qnaRegId" th:value="${session.loginId}" readonly="readonly">
							</div>
							<div class="form-group">
								<label for="exampleInputText">1:1문의 유형</label>
								<div class="select-default">
									<select class="select-option" id="qnaCategoryNum" name="category.qnaCategoryNum">
										<option th:each="qc : ${qnaCateList}" th:value="${qc.qnaCategoryNum}" th:text="${qc.qnaCategoryName}"></option>
										<!-- <option>계정 관리</option>
										<option>이용 문의</option>
										<option>건의 및 제안</option>
										<option>결제 및 환불</option> -->
									</select>
								</div>
							</div>
	
							<div class="form-group">
								<label for="qnaTitle" class="col-sm-2 col-form-label">문의 제목</label>
								<input type="text" class="form-control" id=qnaTitle name="qnaTitle" placeholder="제목" required>
							</div>
	
							<div class="form-group">
								<label for="exampleFormControlTextarea1">문의 내용</label>
								<textarea class="form-control" id="qnaContent" name="qnaContent" rows="6" placeholder="내용을 입력해주세요." required></textarea>
							</div>
	
							<!-- Elements Modal -->
							<div class="pt-5 mb-5" id="modal">
								<div class="row">
									<div class="col-md-6 col-lg-4">
										<h3 class="element-title mb-5">첨부 파일</h3>
										<!-- Button trigger modal -->
										<button id="attachBtn" class="btn btn-primary file-upload-btn" type="button">+ 파일 첨부하기 (0/10)</button>
										<input type="file" id="fileInput" style="display: none;" accept=".jpg, .jpeg, .gif, .png, .pdf" multiple>
										<div id="fileNames"></div>
									</div>
								</div>
							</div>
	
							<div class="d-flex justify-content-end" style="margin-bottom: 50px">
								<!-- 취소 버튼 -->
								<button type="button" class="btn btn-secondary cancle-Btn" data-bs-dismiss="modal">취소</button>
								<!-- 등록 버튼 -->
								<button type="submit" class="btn btn-primary submit-Btn">등록</button>
							</div>
						</form>
					</div>
				</div>
			</div>
		</section>
	</th:block>


	<th:block layout:fragment="customJsFIle">
		<script>
		    document.getElementById('attachBtn').addEventListener('click', function() {
		        document.getElementById('fileInput').click();
		    });
		
		    document.getElementById('fileInput').addEventListener('change', function() {
		        const files = this.files;
		        const fileNamesContainer = document.getElementById('fileNames');
		        const uploadedFiles = fileNamesContainer.getElementsByClassName('thumbnail-container').length;
		        const remainingSlots = 10 - uploadedFiles;
		        
		        if (files.length > remainingSlots) {
		            alert('최대 10개의 파일만 업로드할 수 있습니다.');
		            return;
		        }
		
		        if (files.length > 0) {
		            for (let i = 0; i < files.length; i++) {
		                const file = files[i];
		                const fileName = file.name;
		
		                const thumbnailContainer = document.createElement('div');
		                thumbnailContainer.classList.add('thumbnail-container');
		
		                const thumbnail = document.createElement('img');
		                thumbnail.src = URL.createObjectURL(file);
		                thumbnail.alt = file.name;
		                thumbnail.classList.add('thumbnail');
		                thumbnailContainer.appendChild(thumbnail);
		
		                const fileNameText = document.createElement('div');
		                fileNameText.textContent = fileName;
		                thumbnailContainer.appendChild(fileNameText);
		
		                const deleteButton = document.createElement('button');
		                deleteButton.textContent = 'x';
		                deleteButton.classList.add('delete-button');
		                deleteButton.addEventListener('click', function() {
		                    thumbnailContainer.remove();
		                });
		                thumbnailContainer.appendChild(deleteButton);
		
		                fileNamesContainer.appendChild(thumbnailContainer);
		            }
		        }
		    });
		
		    document.getElementById('submitBtn').addEventListener('click', function() {
		        document.getElementById('postForm').submit();
		    });
		</script>
	</th:block>

</html>